### 分布式锁

使用`setnx`的方式实现分布式锁：

- 有一定的超时时间，大于业务处理所消耗的时间
- finally中需要释放锁
- 高并发锁失效的问题：时间到了删除了线程一的锁，第二个线程进来加上锁，第一个线程把第二个线程的锁删除了

#### 锁防删

- 禁止线程删除其他线程加上的锁：
- setnx lock_key thread_id_value
- 删除之前判断thread_id是否和当前线程的id一致

#### 锁续命

- 分线程：定时任务，锁有个超时时间
- 每隔1/3超时时间检查当前线程的分布式锁是否存在。
- 如果存在就续命。不存在终止当前分线程

## Redisson

> Redisson面向分布式场景，jedis

- 分布式锁
- 分布式集合
- 布隆过滤器等


